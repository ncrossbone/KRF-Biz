<?xml version="1.0" encoding="UTF-8" ?>
<!--
       Copyright 2015-2016 the original author or authors.
       Licensed under the Apache License, Version 2.0 (the "License");
       you may not use this file except in compliance with the License.
       You may obtain a copy of the License at
          http://www.apache.org/licenses/LICENSE-2.0
       Unless required by applicable law or agreed to in writing, software
       distributed under the License is distributed on an "AS IS" BASIS,
       WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
       See the License for the specific language governing permissions and
       limitations under the License.
-->
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ce.krf.biz.mapper.PollutionMapper">
    <select id="pollutionSelect01_01" parameterType="com.ce.krf.biz.model.PollutionVO" resultType="hashmap">
    	WITH TBL_PLA_POP_TOTAL AS (                                                                                                                                                        
	      SELECT YYYY                                                                                           
	           , WS_NM                                                                                          
	           , MB_NM                                                                                          
	           , SB_ID                                                                                          
	           , SB_NM                                                                                          
	           , CAT_DID                                                                                        
	           , ADM_CD                                                                                         
	           , DO_NM||' '||CTY_NM||' '||DONG_NM||' '||RI_NM AS ADDR                                           
	           , FINAL_PERCENTAGE                                                                               
	           , AREA_A1                                                                                        
	           , AREA_A2                                                                                        
	           , AREA_SUM                                                                                       
	           , REGION                                                                                         
	           , REGION_DATE                                                                                    
	           , U_A1_TP_CODE                                                                                   
	           , U_A1_TP_DATE                                                                                   
	           , U_A1_TP_NAME                                                                                   
	           , U_A3_TP_CODE                                                                                   
	           , U_A3_TP_DATE                                                                                   
	           , U_A3_TP_NAME                                                                                   
	           , POP_SUM                                                                                        
	           , UPOP_SUM                                                                                       
	           , UPOP_A1_SUM                                                                                    
	           , UPOP_A1_SEPARATE_WT_SUM                                                                        
	           , UPOP_A1_SEPARATE_IT_SUM                                                                        
	           , UPOP_A1_COMBINED_WT_SUM                                                                        
	           , UPOP_A1_COMBINED_IT_SUM                                                                        
	           , UPOP_A2_SUM                                                                                    
	           , UPOP_A2_SANITARY                                                                               
	           , UPOP_A2_SEPTIC                                                                                 
	           , UPOP_A2_REMOVAL                                                                                
	           , SPOP_SUM                                                                                       
	           , SPOP_A1_SUM                                                                                    
	           , SPOP_A1_SEPARATE_WT_SUM                                                                        
	           , SPOP_A1_SEPARATE_IT_SUM                                                                        
	           , SPOP_A1_COMBINED_WT_SUM                                                                        
	           , SPOP_A1_COMBINED_IT_SUM                                                                        
	           , SPOP_A2_SUM                                                                                    
	           , SPOP_A2_SANITARY                                                                               
	           , SPOP_A2_SEPTIC                                                                                 
	           , SPOP_A2_REMOVAL                                                                                
	        FROM PLA_POP_TOTAL_FOR_CAT                                                                          
		 WHERE CAT_DID IN <foreach collection="catDids" item="item" separator="," open="(" close=")"> #{item}</foreach>	
	       AND YYYY = #{year}                                 
	        )                                                                                                   
	  SELECT  /* KRF-BIZ.PollutionMapper.pollutionSelect01_01 */ 
	         YYYY                                                                                               
	       , WS_NM                                                                                              
	       , MB_NM                                                                                              
	       , SB_NM                                                                                              
	       , POP_SUM                                                                                            
	       , UPOP_SUM                                                                                           
	       , SPOP_SUM                                                                                    
	    FROM (                                                                                                  
	          SELECT YYYY                                                                                       
	               , WS_NM                                                                                      
	               , MB_NM                                                                                      
	               , SB_NM                                                                                      
	               , SB_ID                                                                                      
	               , SUM(AREA_A1) AS AREA_A1                                                                    
	               , SUM(AREA_A2) AS AREA_A2                                                                    
	               , SUM(AREA_SUM) AS AREA_SUM                                                                  
	               , '' AS REGION                                                                               
	               , '' AS REGION_DATE                                                                          
	               , '' AS U_A1_TP_CODE                                                                         
	               , '' AS U_A1_TP_DATE                                                                         
	               , '' AS U_A1_TP_NAME                                                                         
	               , '' AS U_A3_TP_CODE                                                                         
	               , '' AS U_A3_TP_DATE                                                                         
	               , '' AS U_A3_TP_NAME                                                                         
	               , SUM(POP_SUM) AS POP_SUM                                                                    
	               , SUM(UPOP_SUM) AS UPOP_SUM                                                                  
	               , SUM(UPOP_A1_SUM) AS UPOP_A1_SUM                                                            
	               , SUM(UPOP_A1_SEPARATE_WT_SUM) AS UPOP_A1_SEPARATE_WT_SUM                                    
	               , SUM(UPOP_A1_SEPARATE_IT_SUM) AS UPOP_A1_SEPARATE_IT_SUM                                    
	               , SUM(UPOP_A1_COMBINED_WT_SUM) AS UPOP_A1_COMBINED_WT_SUM                                    
	               , SUM(UPOP_A1_COMBINED_IT_SUM) AS UPOP_A1_COMBINED_IT_SUM                                    
	               , SUM(UPOP_A2_SUM) AS UPOP_A2_SUM                                                            
	               , SUM(UPOP_A2_SANITARY) AS UPOP_A2_SANITARY                                                  
	               , SUM(UPOP_A2_SEPTIC) AS UPOP_A2_SEPTIC                                                      
	               , SUM(UPOP_A2_REMOVAL) AS UPOP_A2_REMOVAL                                                    
	               , SUM(SPOP_SUM) AS SPOP_SUM                                                                  
	               , SUM(SPOP_A1_SUM) AS SPOP_A1_SUM                                                            
	               , SUM(SPOP_A1_SEPARATE_WT_SUM) AS SPOP_A1_SEPARATE_WT_SUM                                    
	               , SUM(SPOP_A1_SEPARATE_IT_SUM) AS SPOP_A1_SEPARATE_IT_SUM                                    
	               , SUM(SPOP_A1_COMBINED_WT_SUM) AS SPOP_A1_COMBINED_WT_SUM                                    
	               , SUM(SPOP_A1_COMBINED_IT_SUM) AS SPOP_A1_COMBINED_IT_SUM                                    
	               , SUM(SPOP_A2_SUM) AS SPOP_A2_SUM                                                            
	               , SUM(SPOP_A2_SANITARY) AS SPOP_A2_SANITARY                                                  
	               , SUM(SPOP_A2_SEPTIC) AS SPOP_A2_SEPTIC                                                      
	               , SUM(SPOP_A2_REMOVAL) AS SPOP_A2_REMOVAL                                                    
	            from (                                                                                          
	                  SELECT YYYY                                                                               
	                       , WS_NM                                                                              
	                       , MB_NM                                                                              
	                       , SB_NM                                                                              
	                       , CAT_DID                                                                            
	                       , ADDR                                                                               
	                       , FINAL_PERCENTAGE                                                                   
	                       , ADM_CD                                                                             
	                       , SB_ID                                                                              
	                       , AREA_A1                                                                            
	                       , AREA_A2                                                                            
	                       , AREA_SUM                                                                           
	                       , REGION                                                                             
	                       , REGION_DATE                                                                        
	                       , U_A1_TP_CODE                                                                       
	                       , U_A1_TP_DATE                                                                       
	                       , U_A1_TP_NAME                                                                       
	                       , U_A3_TP_CODE                                                                       
	                       , U_A3_TP_DATE                                                                       
	                       , U_A3_TP_NAME                                                                       
	                       , POP_SUM                                                                            
	                       , UPOP_SUM                                                                           
	                       , UPOP_A1_SUM                                                                        
	                       , UPOP_A1_SEPARATE_WT_SUM                                                            
	                       , UPOP_A1_SEPARATE_IT_SUM                                                            
	                       , UPOP_A1_COMBINED_WT_SUM                                                            
	                       , UPOP_A1_COMBINED_IT_SUM                                                            
	                       , UPOP_A2_SUM                                                                        
	                       , UPOP_A2_SANITARY                                                                   
	                       , UPOP_A2_SEPTIC                                                                     
	                       , UPOP_A2_REMOVAL                                                                    
	                       , SPOP_SUM                                                                           
	                       , SPOP_A1_SUM                                                                        
	                       , SPOP_A1_SEPARATE_WT_SUM                                                            
	                       , SPOP_A1_SEPARATE_IT_SUM                                                            
	                       , SPOP_A1_COMBINED_WT_SUM                                                            
	                       , SPOP_A1_COMBINED_IT_SUM                                                            
	                       , SPOP_A2_SUM                                                                        
	                       , SPOP_A2_SANITARY                                                                   
	                       , SPOP_A2_SEPTIC                                                                     
	                       , SPOP_A2_REMOVAL                                                                    
	                    FROM TBL_PLA_POP_TOTAL                                                                  
	                 )                                                                                          
	          GROUP BY YYYY, WS_NM, MB_NM, SB_NM, SB_ID                                                         
	          UNION                                                                                             
	          SELECT '' AS YYYY                                                                                 
	               , '' AS WS_NM                                                                                
	               , '' AS MB_NM                                                                                
	               , '총계' AS SB_NM                                                                            
	               , '' AS SB_ID                                                                                
	               , SUM(AREA_A1) AS AREA_A1                                                                    
	               , SUM(AREA_A2) AS AREA_A2                                                                    
	               , SUM(AREA_SUM) AS AREA_SUM                                                                  
	               , '' AS REGION                                                                               
	               , '' AS REGION_DATE                                                                          
	               , '' AS U_A1_TP_CODE                                                                         
	               , '' AS U_A1_TP_DATE                                                                         
	               , '' AS U_A1_TP_NAME                                                                         
	               , '' AS U_A3_TP_CODE                                                                         
	               , '' AS U_A3_TP_DATE                                                                         
	               , '' AS U_A3_TP_NAME                                                                         
	               , SUM(POP_SUM) AS POP_SUM                                                                    
	               , SUM(UPOP_SUM) AS UPOP_SUM                                                                  
	               , SUM(UPOP_A1_SUM) AS UPOP_A1_SUM                                                            
	               , SUM(UPOP_A1_SEPARATE_WT_SUM) AS UPOP_A1_SEPARATE_WT_SUM                                    
	               , SUM(UPOP_A1_SEPARATE_IT_SUM) AS UPOP_A1_SEPARATE_IT_SUM                                    
	               , SUM(UPOP_A1_COMBINED_WT_SUM) AS UPOP_A1_COMBINED_WT_SUM                                    
	               , SUM(UPOP_A1_COMBINED_IT_SUM) AS UPOP_A1_COMBINED_IT_SUM                                    
	               , SUM(UPOP_A2_SUM) AS UPOP_A2_SUM                                                            
	               , SUM(UPOP_A2_SANITARY) AS UPOP_A2_SANITARY                                                  
	               , SUM(UPOP_A2_SEPTIC) AS UPOP_A2_SEPTIC                                                      
	               , SUM(UPOP_A2_REMOVAL) AS UPOP_A2_REMOVAL                                                    
	               , SUM(SPOP_SUM) AS SPOP_SUM                                                                  
	               , SUM(SPOP_A1_SUM) AS SPOP_A1_SUM                                                            
	               , SUM(SPOP_A1_SEPARATE_WT_SUM) AS SPOP_A1_SEPARATE_WT_SUM                                    
	               , SUM(SPOP_A1_SEPARATE_IT_SUM) AS SPOP_A1_SEPARATE_IT_SUM                                    
	               , SUM(SPOP_A1_COMBINED_WT_SUM) AS SPOP_A1_COMBINED_WT_SUM                                    
	               , SUM(SPOP_A1_COMBINED_IT_SUM) AS SPOP_A1_COMBINED_IT_SUM                                    
	               , SUM(SPOP_A2_SUM) AS SPOP_A2_SUM                                                            
	               , SUM(SPOP_A2_SANITARY) AS SPOP_A2_SANITARY                                                  
	               , SUM(SPOP_A2_SEPTIC) AS SPOP_A2_SEPTIC                                                      
	               , SUM(SPOP_A2_REMOVAL) AS SPOP_A2_REMOVAL                                                    
	            FROM TBL_PLA_POP_TOTAL                                                                          
	         )                                                                                                  
	   ORDER BY DECODE(SB_NM,'총계',1,2), SB_ID 
    </select>
    <select id="pollutionSelect01_02" parameterType="com.ce.krf.biz.model.PollutionVO" resultType="hashmap">
    	WITH TBL_PLA_POP_TOTAL AS (																																									
			     SELECT YYYY    /*조사년도*/                                                                              
			          , WS_NM   /*대권역*/                                                                                
			          , MB_NM   /*중권역*/                                                                                
			          , SB_ID   /*표준유역코드*/                                                                          
			          , SB_NM   /*표준유역*/                                                                              
			          , CAT_DID /*집수구역*/                                                                              
			          , ADM_CD  /*법정동코드*/                                                                            
			          , DO_NM||' '||CTY_NM||' '||DONG_NM||' '||RI_NM AS ADDR /*법정동리*/                                 
			          , FINAL_PERCENTAGE         /*점유율*/                                                               
			          , AREA_A1                  /*면적_하수처리지역*/                                                    
			          , AREA_A2                  /*면적_하수미처리지역*/                                                  
			          , AREA_SUM                 /*면적_계*/                                                              
			          , REGION                   /*지정내역_종류*/                                                        
			          , REGION_DATE              /*지정내역_편입일자*/                                                    
			          , U_A1_TP_CODE             /*하수처리시설_코드*/                                                    
			          , U_A1_TP_DATE             /*하수처리시설_편입일자*/                                                
			          , U_A1_TP_NAME             /*하수처리시설_시설명*/                                                  
			          , U_A3_TP_CODE             /*분뇨처리시설_코드*/                                                    
			          , U_A3_TP_DATE             /*분뇨처리시설_편입일자*/                                                
			          , U_A3_TP_NAME             /*분뇨처리시설_시설명*/                                                  
			          , POP_SUM                  /*인구 총계*/                                                            
			          , UPOP_SUM                 /*시가지역_합계*/                                                        
			          , UPOP_A1_SUM              /*시가지역_하수처리지역_소계*/                                           
			          , UPOP_A1_SEPARATE_WT_SUM  /*시가지역_하수처리지역_분류식_공공하수처리*/                            
			          , UPOP_A1_SEPARATE_IT_SUM  /*시가지역_하수처리지역_분류식_폐수종말*/                                
			          , UPOP_A1_COMBINED_WT_SUM  /*시가지역_하수처리지역_합류식_공공하수처리*/                            
			          , UPOP_A1_COMBINED_IT_SUM  /*시가지역_하수처리지역_합류식_폐수종말*/                                
			          , UPOP_A2_SUM              /*시가지역_하수미처리지역_소계*/                                         
			          , UPOP_A2_SANITARY         /*시가지역_하수미처리지역_오수*/                                         
			          , UPOP_A2_SEPTIC           /*시가지역_하수미처리지역_정화조*/                                       
			          , UPOP_A2_REMOVAL          /*시가지역_하수미처리지역_수거식*/                                       
			          , SPOP_SUM                 /*비시가지역_합계*/                                                      
			          , SPOP_A1_SUM              /*비시가지역_하수처리지역_소계*/                                         
			          , SPOP_A1_SEPARATE_WT_SUM  /*비시가지역_하수처리지역_분류식_공공하수처리*/                          
			          , SPOP_A1_SEPARATE_IT_SUM  /*비시가지역_하수처리지역_분류식_폐수종말*/                              
			          , SPOP_A1_COMBINED_WT_SUM  /*비시가지역_하수처리지역_합류식_공공하수처리*/                          
			          , SPOP_A1_COMBINED_IT_SUM  /*비시가지역_하수처리지역_합류식_폐수종말*/                              
			          , SPOP_A2_SUM              /*비시가지역_하수미처리지역_소계*/                                       
			          , SPOP_A2_SANITARY         /*비시가지역_하수미처리지역_오수*/                                       
			          , SPOP_A2_SEPTIC           /*비시가지역_하수미처리지역_정화조*/                                     
			          , SPOP_A2_REMOVAL          /*비시가지역_하수미처리지역_정화조*/                                     
			       FROM PLA_POP_TOTAL_FOR_CAT                                                                             
			      WHERE CAT_DID IN <foreach collection="catDids" item="item" separator="," open="(" close=")"> #{item}</foreach>	
	                AND YYYY = #{year}                                
			     )                                                                                                        
			 SELECT /* KRF-BIZ.PollutionMapper.pollutionSelect01_02 */ 
			        YYYY    /*조사년도*/                                                                                  
			      , WS_NM   /*대권역*/                                                                                    
			      , MB_NM   /*중권역*/                                                                                    
			      , SB_NM   /*표준유역*/                                                                                  
			      , AREA_A1                  /*면적_하수처리지역*/                                                        
			      , AREA_A2                  /*면적_하수미처리지역*/                                                      
			      , AREA_SUM                 /*면적_계*/                                                                  
			      , REGION                   /*지정내역_종류*/                                                            
			      , REGION_DATE              /*지정내역_편입일자*/                                                        
			      , U_A1_TP_CODE             /*하수처리시설_코드*/                                                        
			      , U_A1_TP_DATE             /*하수처리시설_편입일자*/                                                    
			      , U_A1_TP_NAME             /*하수처리시설_시설명*/                                                      
			      , U_A3_TP_CODE             /*분뇨처리시설_코드*/                                                        
			      , U_A3_TP_DATE             /*분뇨처리시설_편입일자*/                                                    
			      , U_A3_TP_NAME             /*분뇨처리시설_시설명*/                                                      
			      , POP_SUM                  /*인구 총계*/                                                                
			      , UPOP_SUM                 /*시가지역_합계*/                                                            
			      , UPOP_A1_SUM              /*시가지역_하수처리지역_소계*/                                               
			      , UPOP_A1_SEPARATE_WT_SUM  /*시가지역_하수처리지역_분류식_공공하수처리*/                                
			      , UPOP_A1_SEPARATE_IT_SUM  /*시가지역_하수처리지역_분류식_폐수종말*/                                    
			      , UPOP_A1_COMBINED_WT_SUM  /*시가지역_하수처리지역_합류식_공공하수처리*/                                
			      , UPOP_A1_COMBINED_IT_SUM  /*시가지역_하수처리지역_합류식_폐수종말*/                                    
			      , UPOP_A2_SUM              /*시가지역_하수미처리지역_소계*/                                             
			      , UPOP_A2_SANITARY         /*시가지역_하수미처리지역_오수*/                                             
			      , UPOP_A2_SEPTIC           /*시가지역_하수미처리지역_정화조*/                                           
			      , UPOP_A2_REMOVAL          /*시가지역_하수미처리지역_수거식*/                                           
			      , SPOP_SUM                 /*비시가지역_합계*/                                                          
			      , SPOP_A1_SUM              /*비시가지역_하수처리지역_소계*/                                             
			      , SPOP_A1_SEPARATE_WT_SUM  /*비시가지역_하수처리지역_분류식_공공하수처리*/                              
			      , SPOP_A1_SEPARATE_IT_SUM  /*비시가지역_하수처리지역_분류식_폐수종말*/                                  
			      , SPOP_A1_COMBINED_WT_SUM  /*비시가지역_하수처리지역_합류식_공공하수처리*/                              
			      , SPOP_A1_COMBINED_IT_SUM  /*비시가지역_하수처리지역_합류식_폐수종말*/                                  
			      , SPOP_A2_SUM              /*비시가지역_하수미처리지역_소계*/                                           
			      , SPOP_A2_SANITARY         /*비시가지역_하수미처리지역_오수*/                                           
			      , SPOP_A2_SEPTIC           /*비시가지역_하수미처리지역_정화조*/                                         
			      , SPOP_A2_REMOVAL          /*비시가지역_하수미처리지역_정화조*/                                         
			   FROM (                                                                                                     
			         SELECT YYYY    /*조사년도*/                                                                          
			              , WS_NM   /*대권역*/                                                                            
			              , MB_NM   /*중권역*/                                                                            
			              , SB_NM   /*표준유역*/                                                                          
			              , SB_ID                                                                                         
			              , SUM(AREA_A1) AS AREA_A1                                                                       
			              , SUM(AREA_A2) AS AREA_A2                                                                       
			              , SUM(AREA_SUM) AS AREA_SUM                                                                     
			              , '' AS REGION                                                                                  
			              , '' AS REGION_DATE                                                                             
			              , '' AS U_A1_TP_CODE                                                                            
			              , '' AS U_A1_TP_DATE                                                                            
			              , '' AS U_A1_TP_NAME                                                                            
			              , '' AS U_A3_TP_CODE                                                                            
			              , '' AS U_A3_TP_DATE                                                                            
			              , '' AS U_A3_TP_NAME                                                                            
			              , SUM(POP_SUM) AS POP_SUM                                                                       
			              , SUM(UPOP_SUM) AS UPOP_SUM                                                                     
			              , SUM(UPOP_A1_SUM) AS UPOP_A1_SUM                                                               
			              , SUM(UPOP_A1_SEPARATE_WT_SUM) AS UPOP_A1_SEPARATE_WT_SUM                                       
			              , SUM(UPOP_A1_SEPARATE_IT_SUM) AS UPOP_A1_SEPARATE_IT_SUM                                       
			              , SUM(UPOP_A1_COMBINED_WT_SUM) AS UPOP_A1_COMBINED_WT_SUM                                       
			              , SUM(UPOP_A1_COMBINED_IT_SUM) AS UPOP_A1_COMBINED_IT_SUM                                       
			              , SUM(UPOP_A2_SUM) AS UPOP_A2_SUM                                                               
			              , SUM(UPOP_A2_SANITARY) AS UPOP_A2_SANITARY                                                     
			              , SUM(UPOP_A2_SEPTIC) AS UPOP_A2_SEPTIC                                                         
			              , SUM(UPOP_A2_REMOVAL) AS UPOP_A2_REMOVAL                                                       
			              , SUM(SPOP_SUM) AS SPOP_SUM                                                                     
			              , SUM(SPOP_A1_SUM) AS SPOP_A1_SUM                                                               
			              , SUM(SPOP_A1_SEPARATE_WT_SUM) AS SPOP_A1_SEPARATE_WT_SUM                                       
			              , SUM(SPOP_A1_SEPARATE_IT_SUM) AS SPOP_A1_SEPARATE_IT_SUM                                       
			              , SUM(SPOP_A1_COMBINED_WT_SUM) AS SPOP_A1_COMBINED_WT_SUM                                       
			              , SUM(SPOP_A1_COMBINED_IT_SUM) AS SPOP_A1_COMBINED_IT_SUM                                       
			              , SUM(SPOP_A2_SUM) AS SPOP_A2_SUM                                                               
			              , SUM(SPOP_A2_SANITARY) AS SPOP_A2_SANITARY                                                     
			              , SUM(SPOP_A2_SEPTIC) AS SPOP_A2_SEPTIC                                                         
			              , SUM(SPOP_A2_REMOVAL) AS SPOP_A2_REMOVAL                                                       
			           FROM (                                                                                             
			                 SELECT YYYY    /*조사년도*/                                                                  
			                      , WS_NM   /*대권역*/                                                                    
			                      , MB_NM   /*중권역*/                                                                    
			                      , SB_NM   /*표준유역*/                                                                  
			                      , CAT_DID /*집수구역*/                                                                  
			                      , ADDR    /*법정동리*/                                                                  
			                      , FINAL_PERCENTAGE         /*점유율*/                                                   
			                      , ADM_CD                                                                                
			                      , SB_ID                                                                                 
			                      , AREA_A1                  /*면적_하수처리지역*/                                        
			                      , AREA_A2                  /*면적_하수미처리지역*/                                      
			                      , AREA_SUM                 /*면적_계*/                                                  
			                      , REGION                   /*지정내역_종류*/                                            
			                      , REGION_DATE              /*지정내역_편입일자*/                                        
			                      , U_A1_TP_CODE             /*하수처리시설_코드*/                                        
			                      , U_A1_TP_DATE             /*하수처리시설_편입일자*/                                    
			                      , U_A1_TP_NAME             /*하수처리시설_시설명*/                                      
			                      , U_A3_TP_CODE             /*분뇨처리시설_코드*/                                        
			                      , U_A3_TP_DATE             /*분뇨처리시설_편입일자*/                                    
			                      , U_A3_TP_NAME             /*분뇨처리시설_시설명*/                                      
			                      , POP_SUM                  /*인구 총계*/                                                
			                      , UPOP_SUM                 /*시가지역_합계*/                                            
			                      , UPOP_A1_SUM              /*시가지역_하수처리지역_소계*/                               
			                      , UPOP_A1_SEPARATE_WT_SUM  /*시가지역_하수처리지역_분류식_공공하수처리*/                
			                      , UPOP_A1_SEPARATE_IT_SUM  /*시가지역_하수처리지역_분류식_폐수종말*/                    
			                      , UPOP_A1_COMBINED_WT_SUM  /*시가지역_하수처리지역_합류식_공공하수처리*/                
			                      , UPOP_A1_COMBINED_IT_SUM  /*시가지역_하수처리지역_합류식_폐수종말*/                    
			                      , UPOP_A2_SUM              /*시가지역_하수미처리지역_소계*/                             
			                      , UPOP_A2_SANITARY         /*시가지역_하수미처리지역_오수*/                             
			                      , UPOP_A2_SEPTIC           /*시가지역_하수미처리지역_정화조*/                           
			                      , UPOP_A2_REMOVAL          /*시가지역_하수미처리지역_수거식*/                           
			                      , SPOP_SUM                 /*비시가지역_합계*/                                          
			                      , SPOP_A1_SUM              /*비시가지역_하수처리지역_소계*/                             
			                      , SPOP_A1_SEPARATE_WT_SUM  /*비시가지역_하수처리지역_분류식_공공하수처리*/              
			                      , SPOP_A1_SEPARATE_IT_SUM  /*비시가지역_하수처리지역_분류식_폐수종말*/                  
			                      , SPOP_A1_COMBINED_WT_SUM  /*비시가지역_하수처리지역_합류식_공공하수처리*/              
			                      , SPOP_A1_COMBINED_IT_SUM  /*비시가지역_하수처리지역_합류식_폐수종말*/                  
			                      , SPOP_A2_SUM              /*비시가지역_하수미처리지역_소계*/                           
			                      , SPOP_A2_SANITARY         /*비시가지역_하수미처리지역_오수*/                           
			                      , SPOP_A2_SEPTIC           /*비시가지역_하수미처리지역_정화조*/                         
			                      , SPOP_A2_REMOVAL          /*비시가지역_하수미처리지역_정화조*/                         
			                   FROM TBL_PLA_POP_TOTAL                                                                     
			                )                                                                                             
			         GROUP BY YYYY, WS_NM, MB_NM, SB_NM, SB_ID                                                            
			         UNION                                                                                                
			         SELECT '' AS YYYY                                                                                    
			              , '' AS WS_NM                                                                                   
			              , '' AS MB_NM                                                                                   
			              , '총계' AS SB_NM                                                                               
			              , '' AS SB_ID                                                                                   
			              , SUM(AREA_A1) AS AREA_A1                                                                       
			              , SUM(AREA_A2) AS AREA_A2                                                                       
			              , SUM(AREA_SUM) AS AREA_SUM                                                                     
			              , '' AS REGION                                                                                  
			              , '' AS REGION_DATE                                                                             
			              , '' AS U_A1_TP_CODE                                                                            
			              , '' AS U_A1_TP_DATE                                                                            
			              , '' AS U_A1_TP_NAME                                                                            
			              , '' AS U_A3_TP_CODE                                                                            
			              , '' AS U_A3_TP_DATE                                                                            
			              , '' AS U_A3_TP_NAME                                                                            
			              , SUM(POP_SUM) AS POP_SUM                                                                       
			              , SUM(UPOP_SUM) AS UPOP_SUM                                                                     
			              , SUM(UPOP_A1_SUM) AS UPOP_A1_SUM                                                               
			              , SUM(UPOP_A1_SEPARATE_WT_SUM) AS UPOP_A1_SEPARATE_WT_SUM                                       
			              , SUM(UPOP_A1_SEPARATE_IT_SUM) AS UPOP_A1_SEPARATE_IT_SUM                                       
			              , SUM(UPOP_A1_COMBINED_WT_SUM) AS UPOP_A1_COMBINED_WT_SUM                                       
			              , SUM(UPOP_A1_COMBINED_IT_SUM) AS UPOP_A1_COMBINED_IT_SUM                                       
			              , SUM(UPOP_A2_SUM) AS UPOP_A2_SUM                                                               
			              , SUM(UPOP_A2_SANITARY) AS UPOP_A2_SANITARY                                                     
			              , SUM(UPOP_A2_SEPTIC) AS UPOP_A2_SEPTIC                                                         
			              , SUM(UPOP_A2_REMOVAL) AS UPOP_A2_REMOVAL                                                       
			              , SUM(SPOP_SUM) AS SPOP_SUM                                                                     
			              , SUM(SPOP_A1_SUM) AS SPOP_A1_SUM                                                               
			              , SUM(SPOP_A1_SEPARATE_WT_SUM) AS SPOP_A1_SEPARATE_WT_SUM                                       
			              , SUM(SPOP_A1_SEPARATE_IT_SUM) AS SPOP_A1_SEPARATE_IT_SUM                                       
			              , SUM(SPOP_A1_COMBINED_WT_SUM) AS SPOP_A1_COMBINED_WT_SUM                                       
			              , SUM(SPOP_A1_COMBINED_IT_SUM) AS SPOP_A1_COMBINED_IT_SUM                                       
			              , SUM(SPOP_A2_SUM) AS SPOP_A2_SUM                                                               
			              , SUM(SPOP_A2_SANITARY) AS SPOP_A2_SANITARY                                                     
			              , SUM(SPOP_A2_SEPTIC) AS SPOP_A2_SEPTIC                                                         
			              , SUM(SPOP_A2_REMOVAL) AS SPOP_A2_REMOVAL                                                       
			           FROM TBL_PLA_POP_TOTAL                                                                             
			        )                                                                                                     
			  ORDER BY DECODE(SB_NM,'총계',1,2), SB_ID 
    </select>
    <select id="pollutionSelect01_03" parameterType="com.ce.krf.biz.model.PollutionVO" resultType="hashmap">
		WITH TBL_PLA_POP_TOTAL
		     AS (SELECT YYYY,
		                WS_NM,
		                MB_NM,
		                SB_ID,
		                SB_NM,
		                CAT_DID,
		                ADM_CD,
		                DO_NM || ' ' || CTY_NM || ' ' || DONG_NM || ' ' || RI_NM
		                   AS ADDR,
		                FINAL_PERCENTAGE,
		                AREA_A1,
		                AREA_A2,
		                AREA_SUM,
		                REGION,
		                REGION_DATE,
		                U_A1_TP_CODE,
		                U_A1_TP_DATE,
		                U_A1_TP_NAME,
		                U_A3_TP_CODE,
		                U_A3_TP_DATE,
		                U_A3_TP_NAME,
		                POP_SUM,
		                UPOP_SUM,
		                UPOP_A1_SUM,
		                UPOP_A1_SEPARATE_WT_SUM,
		                UPOP_A1_SEPARATE_IT_SUM,
		                UPOP_A1_COMBINED_WT_SUM,
		                UPOP_A1_COMBINED_IT_SUM,
		                UPOP_A2_SUM,
		                UPOP_A2_SANITARY,
		                UPOP_A2_SEPTIC,
		                UPOP_A2_REMOVAL,
		                SPOP_SUM,
		                SPOP_A1_SUM,
		                SPOP_A1_SEPARATE_WT_SUM,
		                SPOP_A1_SEPARATE_IT_SUM,
		                SPOP_A1_COMBINED_WT_SUM,
		                SPOP_A1_COMBINED_IT_SUM,
		                SPOP_A2_SUM,
		                SPOP_A2_SANITARY,
		                SPOP_A2_SEPTIC,
		                SPOP_A2_REMOVAL
		           FROM PLA_POP_TOTAL_FOR_CAT
		          WHERE CAT_DID IN <foreach collection="catDids" item="item" separator="," open="(" close=")"> #{item}</foreach>	
	                AND YYYY = #{year}   )
		  SELECT /* KRF-BIZ.PollutionMapper.pollutionSelect01_03 */ 
		         YYYY,
		         WS_NM,
		         MB_NM,
		         SB_NM,
		         CAT_DID,
		         AREA_A1,
		         AREA_A2,
		         AREA_SUM,
		         REGION,
		         REGION_DATE,
		         U_A1_TP_CODE,
		         U_A1_TP_DATE,
		         U_A1_TP_NAME,
		         U_A3_TP_CODE,
		         U_A3_TP_DATE,
		         U_A3_TP_NAME,
		         POP_SUM,
		         UPOP_SUM,
		         UPOP_A1_SUM,
		         UPOP_A1_SEPARATE_WT_SUM,
		         UPOP_A1_SEPARATE_IT_SUM,
		         UPOP_A1_COMBINED_WT_SUM,
		         UPOP_A1_COMBINED_IT_SUM,
		         UPOP_A2_SUM,
		         UPOP_A2_SANITARY,
		         UPOP_A2_SEPTIC,
		         UPOP_A2_REMOVAL,
		         SPOP_SUM,
		         SPOP_A1_SUM,
		         SPOP_A1_SEPARATE_WT_SUM,
		         SPOP_A1_SEPARATE_IT_SUM,
		         SPOP_A1_COMBINED_WT_SUM,
		         SPOP_A1_COMBINED_IT_SUM,
		         SPOP_A2_SUM,
		         SPOP_A2_SANITARY,
		         SPOP_A2_SEPTIC,
		         SPOP_A2_REMOVAL
		    FROM (  SELECT YYYY,
		                   WS_NM,
		                   MB_NM,
		                   SB_NM,
		                   CAT_DID,
		                   SB_ID,
		                   SUM (AREA_A1) AS AREA_A1,
		                   SUM (AREA_A2) AS AREA_A2,
		                   SUM (AREA_SUM) AS AREA_SUM,
		                   '' AS REGION,
		                   '' AS REGION_DATE,
		                   '' AS U_A1_TP_CODE,
		                   '' AS U_A1_TP_DATE,
		                   '' AS U_A1_TP_NAME,
		                   '' AS U_A3_TP_CODE,
		                   '' AS U_A3_TP_DATE,
		                   '' AS U_A3_TP_NAME,
		                   SUM (POP_SUM) AS POP_SUM,
		                   SUM (UPOP_SUM) AS UPOP_SUM,
		                   SUM (UPOP_A1_SUM) AS UPOP_A1_SUM,
		                   SUM (UPOP_A1_SEPARATE_WT_SUM) AS UPOP_A1_SEPARATE_WT_SUM,
		                   SUM (UPOP_A1_SEPARATE_IT_SUM) AS UPOP_A1_SEPARATE_IT_SUM,
		                   SUM (UPOP_A1_COMBINED_WT_SUM) AS UPOP_A1_COMBINED_WT_SUM,
		                   SUM (UPOP_A1_COMBINED_IT_SUM) AS UPOP_A1_COMBINED_IT_SUM,
		                   SUM (UPOP_A2_SUM) AS UPOP_A2_SUM,
		                   SUM (UPOP_A2_SANITARY) AS UPOP_A2_SANITARY,
		                   SUM (UPOP_A2_SEPTIC) AS UPOP_A2_SEPTIC,
		                   SUM (UPOP_A2_REMOVAL) AS UPOP_A2_REMOVAL,
		                   SUM (SPOP_SUM) AS SPOP_SUM,
		                   SUM (SPOP_A1_SUM) AS SPOP_A1_SUM,
		                   SUM (SPOP_A1_SEPARATE_WT_SUM) AS SPOP_A1_SEPARATE_WT_SUM,
		                   SUM (SPOP_A1_SEPARATE_IT_SUM) AS SPOP_A1_SEPARATE_IT_SUM,
		                   SUM (SPOP_A1_COMBINED_WT_SUM) AS SPOP_A1_COMBINED_WT_SUM,
		                   SUM (SPOP_A1_COMBINED_IT_SUM) AS SPOP_A1_COMBINED_IT_SUM,
		                   SUM (SPOP_A2_SUM) AS SPOP_A2_SUM,
		                   SUM (SPOP_A2_SANITARY) AS SPOP_A2_SANITARY,
		                   SUM (SPOP_A2_SEPTIC) AS SPOP_A2_SEPTIC,
		                   SUM (SPOP_A2_REMOVAL) AS SPOP_A2_REMOVAL
		              FROM (SELECT YYYY,
		                           WS_NM,
		                           MB_NM,
		                           SB_NM,
		                           CAT_DID,
		                           ADDR,
		                           FINAL_PERCENTAGE,
		                           ADM_CD,
		                           SB_ID,
		                           AREA_A1,
		                           AREA_A2,
		                           AREA_SUM,
		                           REGION,
		                           REGION_DATE,
		                           U_A1_TP_CODE,
		                           U_A1_TP_DATE,
		                           U_A1_TP_NAME,
		                           U_A3_TP_CODE,
		                           U_A3_TP_DATE,
		                           U_A3_TP_NAME,
		                           POP_SUM,
		                           UPOP_SUM,
		                           UPOP_A1_SUM,
		                           UPOP_A1_SEPARATE_WT_SUM,
		                           UPOP_A1_SEPARATE_IT_SUM,
		                           UPOP_A1_COMBINED_WT_SUM,
		                           UPOP_A1_COMBINED_IT_SUM,
		                           UPOP_A2_SUM,
		                           UPOP_A2_SANITARY,
		                           UPOP_A2_SEPTIC,
		                           UPOP_A2_REMOVAL,
		                           SPOP_SUM,
		                           SPOP_A1_SUM,
		                           SPOP_A1_SEPARATE_WT_SUM,
		                           SPOP_A1_SEPARATE_IT_SUM,
		                           SPOP_A1_COMBINED_WT_SUM,
		                           SPOP_A1_COMBINED_IT_SUM,
		                           SPOP_A2_SUM,
		                           SPOP_A2_SANITARY,
		                           SPOP_A2_SEPTIC,
		                           SPOP_A2_REMOVAL
		                      FROM TBL_PLA_POP_TOTAL)
		          GROUP BY YYYY,
		                   WS_NM,
		                   MB_NM,
		                   SB_NM,
		                   SB_ID,
		                   CAT_DID
		          UNION
		            SELECT YYYY,
		                   WS_NM,
		                   MB_NM,
		                   SB_NM,
		                   '소계' AS CAT_DID,
		                   SB_ID,
		                   SUM (AREA_A1) AS AREA_A1,
		                   SUM (AREA_A2) AS AREA_A2,
		                   SUM (AREA_SUM) AS AREA_SUM,
		                   '' AS REGION,
		                   '' AS REGION_DATE,
		                   '' AS U_A1_TP_CODE,
		                   '' AS U_A1_TP_DATE,
		                   '' AS U_A1_TP_NAME,
		                   '' AS U_A3_TP_CODE,
		                   '' AS U_A3_TP_DATE,
		                   '' AS U_A3_TP_NAME,
		                   SUM (POP_SUM) AS POP_SUM,
		                   SUM (UPOP_SUM) AS UPOP_SUM,
		                   SUM (UPOP_A1_SUM) AS UPOP_A1_SUM,
		                   SUM (UPOP_A1_SEPARATE_WT_SUM) AS UPOP_A1_SEPARATE_WT_SUM,
		                   SUM (UPOP_A1_SEPARATE_IT_SUM) AS UPOP_A1_SEPARATE_IT_SUM,
		                   SUM (UPOP_A1_COMBINED_WT_SUM) AS UPOP_A1_COMBINED_WT_SUM,
		                   SUM (UPOP_A1_COMBINED_IT_SUM) AS UPOP_A1_COMBINED_IT_SUM,
		                   SUM (UPOP_A2_SUM) AS UPOP_A2_SUM,
		                   SUM (UPOP_A2_SANITARY) AS UPOP_A2_SANITARY,
		                   SUM (UPOP_A2_SEPTIC) AS UPOP_A2_SEPTIC,
		                   SUM (UPOP_A2_REMOVAL) AS UPOP_A2_REMOVAL,
		                   SUM (SPOP_SUM) AS SPOP_SUM,
		                   SUM (SPOP_A1_SUM) AS SPOP_A1_SUM,
		                   SUM (SPOP_A1_SEPARATE_WT_SUM) AS SPOP_A1_SEPARATE_WT_SUM,
		                   SUM (SPOP_A1_SEPARATE_IT_SUM) AS SPOP_A1_SEPARATE_IT_SUM,
		                   SUM (SPOP_A1_COMBINED_WT_SUM) AS SPOP_A1_COMBINED_WT_SUM,
		                   SUM (SPOP_A1_COMBINED_IT_SUM) AS SPOP_A1_COMBINED_IT_SUM,
		                   SUM (SPOP_A2_SUM) AS SPOP_A2_SUM,
		                   SUM (SPOP_A2_SANITARY) AS SPOP_A2_SANITARY,
		                   SUM (SPOP_A2_SEPTIC) AS SPOP_A2_SEPTIC,
		                   SUM (SPOP_A2_REMOVAL) AS SPOP_A2_REMOVAL
		              FROM (SELECT YYYY,
		                           WS_NM,
		                           MB_NM,
		                           SB_NM,
		                           CAT_DID,
		                           ADDR,
		                           FINAL_PERCENTAGE,
		                           ADM_CD,
		                           SB_ID,
		                           AREA_A1,
		                           AREA_A2,
		                           AREA_SUM,
		                           REGION,
		                           REGION_DATE,
		                           U_A1_TP_CODE,
		                           U_A1_TP_DATE,
		                           U_A1_TP_NAME,
		                           U_A3_TP_CODE,
		                           U_A3_TP_DATE,
		                           U_A3_TP_NAME,
		                           POP_SUM,
		                           UPOP_SUM,
		                           UPOP_A1_SUM,
		                           UPOP_A1_SEPARATE_WT_SUM,
		                           UPOP_A1_SEPARATE_IT_SUM,
		                           UPOP_A1_COMBINED_WT_SUM,
		                           UPOP_A1_COMBINED_IT_SUM,
		                           UPOP_A2_SUM,
		                           UPOP_A2_SANITARY,
		                           UPOP_A2_SEPTIC,
		                           UPOP_A2_REMOVAL,
		                           SPOP_SUM,
		                           SPOP_A1_SUM,
		                           SPOP_A1_SEPARATE_WT_SUM,
		                           SPOP_A1_SEPARATE_IT_SUM,
		                           SPOP_A1_COMBINED_WT_SUM,
		                           SPOP_A1_COMBINED_IT_SUM,
		                           SPOP_A2_SUM,
		                           SPOP_A2_SANITARY,
		                           SPOP_A2_SEPTIC,
		                           SPOP_A2_REMOVAL
		                      FROM TBL_PLA_POP_TOTAL)
		          GROUP BY YYYY,
		                   WS_NM,
		                   MB_NM,
		                   SB_NM,
		                   SB_ID
		          UNION
		          SELECT '' AS YYYY,
		                 '' AS WS_NM,
		                 '' AS MB_NM,
		                 '총계' AS SB_NM,
		                 '' AS CAT_DID,
		                 '' AS SB_ID,
		                 SUM (AREA_A1) AS AREA_A1,
		                 SUM (AREA_A2) AS AREA_A2,
		                 SUM (AREA_SUM) AS AREA_SUM,
		                 '' AS REGION,
		                 '' AS REGION_DATE,
		                 '' AS U_A1_TP_CODE,
		                 '' AS U_A1_TP_DATE,
		                 '' AS U_A1_TP_NAME,
		                 '' AS U_A3_TP_CODE,
		                 '' AS U_A3_TP_DATE,
		                 '' AS U_A3_TP_NAME,
		                 SUM (POP_SUM) AS POP_SUM,
		                 SUM (UPOP_SUM) AS UPOP_SUM,
		                 SUM (UPOP_A1_SUM) AS UPOP_A1_SUM,
		                 SUM (UPOP_A1_SEPARATE_WT_SUM) AS UPOP_A1_SEPARATE_WT_SUM,
		                 SUM (UPOP_A1_SEPARATE_IT_SUM) AS UPOP_A1_SEPARATE_IT_SUM,
		                 SUM (UPOP_A1_COMBINED_WT_SUM) AS UPOP_A1_COMBINED_WT_SUM,
		                 SUM (UPOP_A1_COMBINED_IT_SUM) AS UPOP_A1_COMBINED_IT_SUM,
		                 SUM (UPOP_A2_SUM) AS UPOP_A2_SUM,
		                 SUM (UPOP_A2_SANITARY) AS UPOP_A2_SANITARY,
		                 SUM (UPOP_A2_SEPTIC) AS UPOP_A2_SEPTIC,
		                 SUM (UPOP_A2_REMOVAL) AS UPOP_A2_REMOVAL,
		                 SUM (SPOP_SUM) AS SPOP_SUM,
		                 SUM (SPOP_A1_SUM) AS SPOP_A1_SUM,
		                 SUM (SPOP_A1_SEPARATE_WT_SUM) AS SPOP_A1_SEPARATE_WT_SUM,
		                 SUM (SPOP_A1_SEPARATE_IT_SUM) AS SPOP_A1_SEPARATE_IT_SUM,
		                 SUM (SPOP_A1_COMBINED_WT_SUM) AS SPOP_A1_COMBINED_WT_SUM,
		                 SUM (SPOP_A1_COMBINED_IT_SUM) AS SPOP_A1_COMBINED_IT_SUM,
		                 SUM (SPOP_A2_SUM) AS SPOP_A2_SUM,
		                 SUM (SPOP_A2_SANITARY) AS SPOP_A2_SANITARY,
		                 SUM (SPOP_A2_SEPTIC) AS SPOP_A2_SEPTIC,
		                 SUM (SPOP_A2_REMOVAL) AS SPOP_A2_REMOVAL
		            FROM TBL_PLA_POP_TOTAL)
		ORDER BY DECODE (SB_NM, '총계', 1, 2),
		         SB_ID,
		         DECODE (CAT_DID, '소계', 1, 2),
		         CAT_DID
    </select>
    <select id="pollutionSelect01_04" parameterType="com.ce.krf.biz.model.PollutionVO" resultType="hashmap">
    	WITH TBL_PLA_POP_TOTAL AS (																																						
			     SELECT YYYY    /*조사년도*/                                                                        
			          , WS_NM   /*대권역*/                                                                          
			          , MB_NM   /*중권역*/                                                                          
			          , SB_ID   /*표준유역코드*/                                                                    
			          , SB_NM   /*표준유역*/                                                                        
			          , CAT_DID /*집수구역*/                                                                        
			          , ADM_CD  /*법정동코드*/                                                                      
			          , DO_NM||' '||CTY_NM||' '||DONG_NM||' '||RI_NM AS ADDR /*법정동리*/                           
			          , FINAL_PERCENTAGE         /*점유율*/                                                         
			          , AREA_A1                  /*면적_하수처리지역*/                                              
			          , AREA_A2                  /*면적_하수미처리지역*/                                            
			          , AREA_SUM                 /*면적_계*/                                                        
			          , REGION                   /*지정내역_종류*/                                                  
			          , REGION_DATE              /*지정내역_편입일자*/                                              
			          , U_A1_TP_CODE             /*하수처리시설_코드*/                                              
			          , U_A1_TP_DATE             /*하수처리시설_편입일자*/                                          
			          , U_A1_TP_NAME             /*하수처리시설_시설명*/                                            
			          , U_A3_TP_CODE             /*분뇨처리시설_코드*/                                              
			          , U_A3_TP_DATE             /*분뇨처리시설_편입일자*/                                          
			          , U_A3_TP_NAME             /*분뇨처리시설_시설명*/                                            
			          , POP_SUM                  /*인구 총계*/                                                      
			          , UPOP_SUM                 /*시가지역_합계*/                                                  
			          , UPOP_A1_SUM              /*시가지역_하수처리지역_소계*/                                     
			          , UPOP_A1_SEPARATE_WT_SUM  /*시가지역_하수처리지역_분류식_공공하수처리*/                      
			          , UPOP_A1_SEPARATE_IT_SUM  /*시가지역_하수처리지역_분류식_폐수종말*/                          
			          , UPOP_A1_COMBINED_WT_SUM  /*시가지역_하수처리지역_합류식_공공하수처리*/                      
			          , UPOP_A1_COMBINED_IT_SUM  /*시가지역_하수처리지역_합류식_폐수종말*/                          
			          , UPOP_A2_SUM              /*시가지역_하수미처리지역_소계*/                                   
			          , UPOP_A2_SANITARY         /*시가지역_하수미처리지역_오수*/                                   
			          , UPOP_A2_SEPTIC           /*시가지역_하수미처리지역_정화조*/                                 
			          , UPOP_A2_REMOVAL          /*시가지역_하수미처리지역_수거식*/                                 
			          , SPOP_SUM                 /*비시가지역_합계*/                                                
			          , SPOP_A1_SUM              /*비시가지역_하수처리지역_소계*/                                   
			          , SPOP_A1_SEPARATE_WT_SUM  /*비시가지역_하수처리지역_분류식_공공하수처리*/                    
			          , SPOP_A1_SEPARATE_IT_SUM  /*비시가지역_하수처리지역_분류식_폐수종말*/                        
			          , SPOP_A1_COMBINED_WT_SUM  /*비시가지역_하수처리지역_합류식_공공하수처리*/                    
			          , SPOP_A1_COMBINED_IT_SUM  /*비시가지역_하수처리지역_합류식_폐수종말*/                        
			          , SPOP_A2_SUM              /*비시가지역_하수미처리지역_소계*/                                 
			          , SPOP_A2_SANITARY         /*비시가지역_하수미처리지역_오수*/                                 
			          , SPOP_A2_SEPTIC           /*비시가지역_하수미처리지역_정화조*/                               
			          , SPOP_A2_REMOVAL          /*비시가지역_하수미처리지역_정화조*/                               
			       FROM PLA_POP_TOTAL_FOR_CAT                                                                       
				  WHERE CAT_DID IN <foreach collection="catDids" item="item" separator="," open="(" close=")"> #{item}</foreach>	
	                AND YYYY = #{year}                                                                 
			     )                                                                                                  
			 SELECT /* KRF-BIZ.PollutionMapper.pollutionSelect01_04 */
			        YYYY    /*조사년도*/                                                                            
			      , WS_NM   /*대권역*/                                                                              
			      , MB_NM   /*중권역*/                                                                              
			      , SB_NM   /*표준유역*/                                                                            
			      , CAT_DID /*집수구역*/                                                                            
			      , ADDR    /*법정동리*/                                                                            
			      , FINAL_PERCENTAGE         /*점유율*/                                                             
			      , AREA_A1                  /*면적_하수처리지역*/                                                  
			      , AREA_A2                  /*면적_하수미처리지역*/                                                
			      , AREA_SUM                 /*면적_계*/                                                            
			      , REGION                   /*지정내역_종류*/                                                      
			      , REGION_DATE              /*지정내역_편입일자*/                                                  
			      , U_A1_TP_CODE             /*하수처리시설_코드*/                                                  
			      , U_A1_TP_DATE             /*하수처리시설_편입일자*/                                              
			      , U_A1_TP_NAME             /*하수처리시설_시설명*/                                                
			      , U_A3_TP_CODE             /*분뇨처리시설_코드*/                                                  
			      , U_A3_TP_DATE             /*분뇨처리시설_편입일자*/                                              
			      , U_A3_TP_NAME             /*분뇨처리시설_시설명*/                                                
			      , POP_SUM                  /*인구 총계*/                                                          
			      , UPOP_SUM                 /*시가지역_합계*/                                                      
			      , UPOP_A1_SUM              /*시가지역_하수처리지역_소계*/                                         
			      , UPOP_A1_SEPARATE_WT_SUM  /*시가지역_하수처리지역_분류식_공공하수처리*/                          
			      , UPOP_A1_SEPARATE_IT_SUM  /*시가지역_하수처리지역_분류식_폐수종말*/                              
			      , UPOP_A1_COMBINED_WT_SUM  /*시가지역_하수처리지역_합류식_공공하수처리*/                          
			      , UPOP_A1_COMBINED_IT_SUM  /*시가지역_하수처리지역_합류식_폐수종말*/                              
			      , UPOP_A2_SUM              /*시가지역_하수미처리지역_소계*/                                       
			      , UPOP_A2_SANITARY         /*시가지역_하수미처리지역_오수*/                                       
			      , UPOP_A2_SEPTIC           /*시가지역_하수미처리지역_정화조*/                                     
			      , UPOP_A2_REMOVAL          /*시가지역_하수미처리지역_수거식*/                                     
			      , SPOP_SUM                 /*비시가지역_합계*/                                                    
			      , SPOP_A1_SUM              /*비시가지역_하수처리지역_소계*/                                       
			      , SPOP_A1_SEPARATE_WT_SUM  /*비시가지역_하수처리지역_분류식_공공하수처리*/                        
			      , SPOP_A1_SEPARATE_IT_SUM  /*비시가지역_하수처리지역_분류식_폐수종말*/                            
			      , SPOP_A1_COMBINED_WT_SUM  /*비시가지역_하수처리지역_합류식_공공하수처리*/                        
			      , SPOP_A1_COMBINED_IT_SUM  /*비시가지역_하수처리지역_합류식_폐수종말*/                            
			      , SPOP_A2_SUM              /*비시가지역_하수미처리지역_소계*/                                     
			      , SPOP_A2_SANITARY         /*비시가지역_하수미처리지역_오수*/                                     
			      , SPOP_A2_SEPTIC           /*비시가지역_하수미처리지역_정화조*/                                   
			      , SPOP_A2_REMOVAL          /*비시가지역_하수미처리지역_정화조*/                                   
			   FROM (                                                                                               
			         SELECT YYYY                                                                                    
			              , WS_NM                                                                                   
			              , MB_NM                                                                                   
			              , SB_NM                                                                                   
			              , CAT_DID                                                                                 
			              , '소계' AS ADDR                                                                          
			              , '' AS FINAL_PERCENTAGE                                                                  
			              , '' AS ADM_CD                                                                            
			              , SB_ID                                                                                   
			              , SUM(AREA_A1) AS AREA_A1                                                                 
			              , SUM(AREA_A2) AS AREA_A2                                                                 
			              , SUM(AREA_SUM) AS AREA_SUM                                                               
			              , '' AS REGION                                                                            
			              , '' AS REGION_DATE                                                                       
			              , '' AS U_A1_TP_CODE                                                                      
			              , '' AS U_A1_TP_DATE                                                                      
			              , '' AS U_A1_TP_NAME                                                                      
			              , '' AS U_A3_TP_CODE                                                                      
			              , '' AS U_A3_TP_DATE                                                                      
			              , '' AS U_A3_TP_NAME                                                                      
			              , SUM(POP_SUM) AS POP_SUM                                                                 
			              , SUM(UPOP_SUM) AS UPOP_SUM                                                               
			              , SUM(UPOP_A1_SUM) AS UPOP_A1_SUM                                                         
			              , SUM(UPOP_A1_SEPARATE_WT_SUM) AS UPOP_A1_SEPARATE_WT_SUM                                 
			              , SUM(UPOP_A1_SEPARATE_IT_SUM) AS UPOP_A1_SEPARATE_IT_SUM                                 
			              , SUM(UPOP_A1_COMBINED_WT_SUM) AS UPOP_A1_COMBINED_WT_SUM                                 
			              , SUM(UPOP_A1_COMBINED_IT_SUM) AS UPOP_A1_COMBINED_IT_SUM                                 
			              , SUM(UPOP_A2_SUM) AS UPOP_A2_SUM                                                         
			              , SUM(UPOP_A2_SANITARY) AS UPOP_A2_SANITARY                                               
			              , SUM(UPOP_A2_SEPTIC) AS UPOP_A2_SEPTIC                                                   
			              , SUM(UPOP_A2_REMOVAL) AS UPOP_A2_REMOVAL                                                 
			              , SUM(SPOP_SUM) AS SPOP_SUM                                                               
			              , SUM(SPOP_A1_SUM) AS SPOP_A1_SUM                                                         
			              , SUM(SPOP_A1_SEPARATE_WT_SUM) AS SPOP_A1_SEPARATE_WT_SUM                                 
			              , SUM(SPOP_A1_SEPARATE_IT_SUM) AS SPOP_A1_SEPARATE_IT_SUM                                 
			              , SUM(SPOP_A1_COMBINED_WT_SUM) AS SPOP_A1_COMBINED_WT_SUM                                 
			              , SUM(SPOP_A1_COMBINED_IT_SUM) AS SPOP_A1_COMBINED_IT_SUM                                 
			              , SUM(SPOP_A2_SUM) AS SPOP_A2_SUM                                                         
			              , SUM(SPOP_A2_SANITARY) AS SPOP_A2_SANITARY                                               
			              , SUM(SPOP_A2_SEPTIC) AS SPOP_A2_SEPTIC                                                   
			              , SUM(SPOP_A2_REMOVAL) AS SPOP_A2_REMOVAL                                                 
			           FROM TBL_PLA_POP_TOTAL                                                                       
			          GROUP BY YYYY, WS_NM, MB_NM, SB_NM, SB_ID, CAT_DID                                            
			         UNION                                                                                          
			         SELECT YYYY    /*조사년도*/                                                                    
			              , WS_NM   /*대권역*/                                                                      
			              , MB_NM   /*중권역*/                                                                      
			              , SB_NM   /*표준유역*/                                                                    
			              , CAT_DID /*집수구역*/                                                                    
			              , ADDR    /*법정동리*/                                                                    
			              , FINAL_PERCENTAGE         /*점유율*/                                                     
			              , ADM_CD                                                                                  
			              , SB_ID                                                                                   
			              , AREA_A1                  /*면적_하수처리지역*/                                          
			              , AREA_A2                  /*면적_하수미처리지역*/                                        
			              , AREA_SUM                 /*면적_계*/                                                    
			              , REGION                   /*지정내역_종류*/                                              
			              , REGION_DATE              /*지정내역_편입일자*/                                          
			              , U_A1_TP_CODE             /*하수처리시설_코드*/                                          
			              , U_A1_TP_DATE             /*하수처리시설_편입일자*/                                      
			              , U_A1_TP_NAME             /*하수처리시설_시설명*/                                        
			              , U_A3_TP_CODE             /*분뇨처리시설_코드*/                                          
			              , U_A3_TP_DATE             /*분뇨처리시설_편입일자*/                                      
			              , U_A3_TP_NAME             /*분뇨처리시설_시설명*/                                        
			              , POP_SUM                  /*인구 총계*/                                                  
			              , UPOP_SUM                 /*시가지역_합계*/                                              
			              , UPOP_A1_SUM              /*시가지역_하수처리지역_소계*/                                 
			              , UPOP_A1_SEPARATE_WT_SUM  /*시가지역_하수처리지역_분류식_공공하수처리*/                  
			              , UPOP_A1_SEPARATE_IT_SUM  /*시가지역_하수처리지역_분류식_폐수종말*/                      
			              , UPOP_A1_COMBINED_WT_SUM  /*시가지역_하수처리지역_합류식_공공하수처리*/                  
			              , UPOP_A1_COMBINED_IT_SUM  /*시가지역_하수처리지역_합류식_폐수종말*/                      
			              , UPOP_A2_SUM              /*시가지역_하수미처리지역_소계*/                               
			              , UPOP_A2_SANITARY         /*시가지역_하수미처리지역_오수*/                               
			              , UPOP_A2_SEPTIC           /*시가지역_하수미처리지역_정화조*/                             
			              , UPOP_A2_REMOVAL          /*시가지역_하수미처리지역_수거식*/                             
			              , SPOP_SUM                 /*비시가지역_합계*/                                            
			              , SPOP_A1_SUM              /*비시가지역_하수처리지역_소계*/                               
			              , SPOP_A1_SEPARATE_WT_SUM  /*비시가지역_하수처리지역_분류식_공공하수처리*/                
			              , SPOP_A1_SEPARATE_IT_SUM  /*비시가지역_하수처리지역_분류식_폐수종말*/                    
			              , SPOP_A1_COMBINED_WT_SUM  /*비시가지역_하수처리지역_합류식_공공하수처리*/                
			              , SPOP_A1_COMBINED_IT_SUM  /*비시가지역_하수처리지역_합류식_폐수종말*/                    
			              , SPOP_A2_SUM              /*비시가지역_하수미처리지역_소계*/                             
			              , SPOP_A2_SANITARY         /*비시가지역_하수미처리지역_오수*/                             
			              , SPOP_A2_SEPTIC           /*비시가지역_하수미처리지역_정화조*/                           
			              , SPOP_A2_REMOVAL          /*비시가지역_하수미처리지역_정화조*/                           
			           FROM TBL_PLA_POP_TOTAL                                                                       
			         UNION                                                                                          
			         SELECT '' AS YYYY                                                                              
			              , '' AS WS_NM                                                                             
			              , '' AS MB_NM                                                                             
			              , '' AS SB_NM                                                                             
			              , '' AS CAT_DID                                                                           
			              , '총계' AS ADDR                                                                          
			              , '' AS FINAL_PERCENTAGE                                                                  
			              , '' AS ADM_CD                                                                            
			              , '' AS SB_ID                                                                             
			              , SUM(AREA_A1) AS AREA_A1                                                                 
			              , SUM(AREA_A2) AS AREA_A2                                                                 
			              , SUM(AREA_SUM) AS AREA_SUM                                                               
			              , '' AS REGION                                                                            
			              , '' AS REGION_DATE                                                                       
			              , '' AS U_A1_TP_CODE                                                                      
			              , '' AS U_A1_TP_DATE                                                                      
			              , '' AS U_A1_TP_NAME                                                                      
			              , '' AS U_A3_TP_CODE                                                                      
			              , '' AS U_A3_TP_DATE                                                                      
			              , '' AS U_A3_TP_NAME                                                                      
			              , SUM(POP_SUM) AS POP_SUM                                                                 
			              , SUM(UPOP_SUM) AS UPOP_SUM                                                               
			              , SUM(UPOP_A1_SUM) AS UPOP_A1_SUM                                                         
			              , SUM(UPOP_A1_SEPARATE_WT_SUM) AS UPOP_A1_SEPARATE_WT_SUM                                 
			              , SUM(UPOP_A1_SEPARATE_IT_SUM) AS UPOP_A1_SEPARATE_IT_SUM                                 
			              , SUM(UPOP_A1_COMBINED_WT_SUM) AS UPOP_A1_COMBINED_WT_SUM                                 
			              , SUM(UPOP_A1_COMBINED_IT_SUM) AS UPOP_A1_COMBINED_IT_SUM                                 
			              , SUM(UPOP_A2_SUM) AS UPOP_A2_SUM                                                         
			              , SUM(UPOP_A2_SANITARY) AS UPOP_A2_SANITARY                                               
			              , SUM(UPOP_A2_SEPTIC) AS UPOP_A2_SEPTIC                                                   
			              , SUM(UPOP_A2_REMOVAL) AS UPOP_A2_REMOVAL                                                 
			              , SUM(SPOP_SUM) AS SPOP_SUM                                                               
			              , SUM(SPOP_A1_SUM) AS SPOP_A1_SUM                                                         
			              , SUM(SPOP_A1_SEPARATE_WT_SUM) AS SPOP_A1_SEPARATE_WT_SUM                                 
			              , SUM(SPOP_A1_SEPARATE_IT_SUM) AS SPOP_A1_SEPARATE_IT_SUM                                 
			              , SUM(SPOP_A1_COMBINED_WT_SUM) AS SPOP_A1_COMBINED_WT_SUM                                 
			              , SUM(SPOP_A1_COMBINED_IT_SUM) AS SPOP_A1_COMBINED_IT_SUM                                 
			              , SUM(SPOP_A2_SUM) AS SPOP_A2_SUM                                                         
			              , SUM(SPOP_A2_SANITARY) AS SPOP_A2_SANITARY                                               
			              , SUM(SPOP_A2_SEPTIC) AS SPOP_A2_SEPTIC                                                   
			              , SUM(SPOP_A2_REMOVAL) AS SPOP_A2_REMOVAL                                                 
			           FROM TBL_PLA_POP_TOTAL                                                                       
			        )                                                                                               
			  ORDER BY DECODE(ADDR,'총계',1,2), SB_ID, CAT_DID, DECODE(ADDR,'소계',1,2), ADM_CD
    </select>
</mapper>